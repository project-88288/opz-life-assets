"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const command_1 = require("@oclif/command");
const terra_js_1 = require("@terra-money/terra.js");
const TerrainCLI_1 = tslib_1.__importDefault(require("../../TerrainCLI"));
const fs = tslib_1.__importStar(require("fs"));
class WalletNew extends command_1.Command {
    async run() {
        const { flags } = this.parse(WalletNew);
        this.log('Generating new terra-wallet');
        const mk = new terra_js_1.MnemonicKey({
            index: flags.index,
        });
        if (flags.outfile) {
            if (fs.existsSync(flags.outfile)) {
                this.error(`outfile: '${flags.outfile}' already exists, abort`);
                this.exit(1);
            }
            this.log(`saving mnemonic to '${flags.outfile}'`);
            fs.writeFileSync(flags.outfile, mk.mnemonic);
            this.exit(0);
        }
        TerrainCLI_1.default.warning('Anyone who gains access to your seed phrase can access the contents of the corresponding wallet. Be cognizant of the fact that there is no recourse for theft of a seed phrase.');
        this.log('address:');
        this.log(mk.accAddress);
        this.log('mnemonic key:');
        this.log(mk.mnemonic);
        this.exit(0);
    }
}
exports.default = WalletNew;
WalletNew.description = 'Generate a new wallet to use for signing contracts';
WalletNew.flags = {
    outfile: command_1.flags.string({
        description: 'absolute path to store the mnemonic key to. If omitted, output to stdout',
    }),
    index: command_1.flags.integer({
        description: 'key index to use, default value is 0',
        default: 0,
    }),
};
